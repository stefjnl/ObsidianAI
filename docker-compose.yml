services:
  web:
    build:
      context: .
      dockerfile: ObsidianAI.Web/Dockerfile
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ConnectionStrings__ObsidianAI: Data Source=/app/data/obsidianai.db
      LLM__Provider: ${LLM__Provider}
      LLM__LMStudio__Endpoint: ${LLM__LMStudio__Endpoint}
      LLM__LMStudio__ApiKey: ${LLM__LMStudio__ApiKey}
      LLM__LMStudio__Model: ${LLM__LMStudio__Model}
      LLM__OpenRouter__Endpoint: ${LLM__OpenRouter__Endpoint}
      LLM__OpenRouter__ApiKey: ${LLM__OpenRouter__ApiKey}
      OpenRouter__ApiKey: ${LLM__OpenRouter__ApiKey}
      LLM__OpenRouter__Model: ${LLM__OpenRouter__Model}
      LLM__NanoGPT__Endpoint: ${LLM__NanoGPT__Endpoint:-}
      LLM__NanoGPT__Model: ${LLM__NanoGPT__Model:-}
      MCP_ENDPOINT: http://host.docker.internal:8033/mcp
      MCP_GATEWAY_AUTH_TOKEN: ${MCP_GATEWAY_AUTH_TOKEN}
      MicrosoftLearnMcp__Endpoint: ${MicrosoftLearnMcp__Endpoint:-}
      ApiBaseUrl: http://localhost:8080
    volumes:
      - obsidianai-data:/app/data
    ports:
      - "5244:8080"
    extra_hosts:
      - "host.docker.internal:host-gateway"
volumes:
  obsidianai-data:
